<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE data SYSTEM "../../../lib/pkp/dtd/xmlData.dtd">

<!--
  * 2.3.2_update.xml
  *
  * Copyright (c) 2000-2010 John Willinsky
  * Distributed under the GNU GPL v2. For full terms see the file docs/COPYING.
  *
  * 2.3.2 database updates XML file.
  *
  -->

<data>
	<!-- Bug #5440: Migrate submission notes into PKP "notes" -->
	<sql>
		<query>UPDATE notes SET assoc_type = 257</query><!-- ASSOC_TYPE_ARTICLE -->
	</sql>
	<!-- Bug #5543: Implement multilingual specification -->
	<sql>
		<query driver="mysql">
			UPDATE papers p, conferences c, sched_confs sc SET p.locale = c.primary_locale WHERE p.sched_conf_id = sc.sched_conf_id AND sc.conference_id = c.conference_id
		</query>
		<query driver="postgres7">
			UPDATE papers SET locale = c.primary_locale FROM sched_confs sc, conferences c WHERE papers.sched_conf_id = sc.sched_conf_id AND sc.conference_id = c.conference_id
		</query>
		<!-- Use the current set of form locales as a default for supported submission locales -->
		<query>
			INSERT INTO conference_settings (conference_id, locale, setting_name, setting_value, setting_type) SELECT conference_id, locale, 'supportedSubmissionLocales', setting_value, setting_type FROM conference_settings WHERE setting_name = 'supportedFormLocales'
		</query>
	</sql>
</data>
